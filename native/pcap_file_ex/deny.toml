# cargo-deny configuration
# This file configures security and license auditing for Rust dependencies
# See: https://embarkstudios.github.io/cargo-deny/

# Security advisories check
[advisories]
version = 2
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]
# Fail on security vulnerabilities
vulnerability = "deny"
# Warn on unmaintained crates (don't fail)
unmaintained = "warn"
# Warn on yanked crates
yanked = "warn"
# Ignore specific advisories (none currently)
ignore = []

# License compliance check
[licenses]
version = 2
# Fail on unknown licenses
unlicensed = "deny"
# Allow permissive licenses commonly used in Rust ecosystem
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Unicode-DFS-2016",
    "Zlib",
]
# Warn about copyleft licenses (review needed)
copyleft = "warn"
# Allow OSI-approved and FSF-approved licenses by default
allow-osi-fsf-free = "both"
# Clarify ambiguous license expressions
[[licenses.clarify]]
name = "ring"
expression = "MIT AND ISC AND OpenSSL"
license-files = [
    { path = "LICENSE", hash = 0xbd0eed23 }
]

# Banned dependencies
[bans]
version = 2
# Multiple versions of the same crate (warn to keep builds clean)
multiple-versions = "warn"
# Wildcards in dependencies are not recommended
wildcards = "warn"
# Allow git dependencies (we use pcap-file from git)
allow-git-deps = true
# List of explicitly banned crates (none currently)
skip = []
skip-tree = []

# Source code check (only allow crates.io and git)
[sources]
version = 2
unknown-registry = "deny"
unknown-git = "warn"
allow-registry = ["https://github.com/rust-lang/crates.io-index"]
# Allow git sources (we use pcap-file from our fork)
# Pinned to commit e60e2f9b (Oct 2, 2025) for stability
allow-git = [
    "https://github.com/lucian/pcap-file"
]
